# Задача: Исправление функции parseTemplateLiteral

## Описание проблемы

Функция `parseTemplateLiteral` в файле `data.ts` неправильно обрабатывает template literals в атрибутах HTML элементов.

## Цель

Создать строки, которые можно безопасно выполнить через `eval()` или `Function` конструктор, передавая переменные как аргументы.

## Принцип работы

1. **Сохранить template literal как есть** - не убирать `${}`
2. **Заменить переменные на `arguments[0]`, `arguments[1]`, `arguments[2]`** - чтобы можно было передать значения через массив аргументов

## Примеры входных и выходных данных

### Входные данные:

```javascript
"${core.active ? 'active' : 'inactive'}"
"item-${core.user.id}"
"${core.count > 5 ? 'large' : 'small'}"
"${core.user.id}-${core.user.role}-${core.theme}"
```

### Ожидаемый результат:

```javascript
"${arguments[0] ? 'active' : 'inactive'}"
"item-${arguments[0]}"
"${arguments[0] > 5 ? 'large' : 'small'}"
"${arguments[0]}-${arguments[1]}-${arguments[2]}"
```

## Использование результата

```javascript
// Вариант 1: Function конструктор
const expr = "${arguments[0] ? 'active' : 'inactive'}"
const variables = [core.active]
const func = new Function(expr)
const result = func(...variables)

// Вариант 2: eval
const expr = "arguments[0] ? 'active' : 'inactive'"
const variables = [core.active]
const result = eval(`(function() { return ${expr}; })`)(...variables)
```

## Этапы решения

### Этап 1: Анализ текущего кода

- [x] Изучить функцию `parseTemplateLiteral` в `data.ts`
- [x] Понять, как она обрабатывает template literals
- [x] Выявить проблемы в текущей реализации

### Этап 2: Исправление проблем

- [x] Убрать строку, которая убирает внешние `${}`
- [x] Исправить замену переменных на правильный формат

### Этап 3: Реализация замены переменных

- [x] Изменить регулярное выражение для замены переменных
- [x] Заменить переменные на `arguments[index]` формат
- [x] Сохранить порядок переменных в массиве

### Этап 4: Тестирование

- [x] Запустить тесты `tests/data/class.spec.ts`
- [x] Проверить, что все тесты проходят (12/27 проходят)
- [x] Исправить форматирование пробелов в выражениях
- [ ] Исправить проблемы с обработкой смешанных значений
- [ ] Убедиться, что формат соответствует ожиданиям

## Текущий статус

✅ **Выполнено:**

- Убрана строка, которая убирала внешние `${}`
- Реализована замена переменных на `arguments[0]`, `arguments[1]`, `arguments[2]`
- Сохранен порядок переменных в массиве
- Исправлено форматирование пробелов
- Обновлены все тесты для нового формата

❌ **Проблемы:**

- Некоторые тесты возвращают `value` вместо `expr` (функция не вызывается)
- Некоторые тесты ожидают другой формат для смешанных значений
- Проблемы с обработкой сложных выражений

## Следующие шаги

1. Исправить логику добавления пробелов
2. Проанализировать, почему некоторые тесты ожидают `"value"` вместо `"expr"`
3. Довести количество проходящих тестов до 27/27

## Текущие проблемы

1. **Функция убирает внешние `${}`** - нужно сохранить их
2. **Неправильный формат замены** - сейчас `0`, `1`, `2`, нужно `arguments[0]`, `arguments[1]`, `arguments[2]`

## Файлы для изменения

- `data.ts` - основная функция `parseTemplateLiteral`
- `tests/data/class.spec.ts` - тесты для проверки результата

## Ожидаемый результат

Все тесты в `tests/data/class.spec.ts` должны проходить с правильным форматом выражений.
